<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Form Data Rekam Medis Pasien</title>
    <link href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i"
        rel="stylesheet">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <!-- Font Awesome CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/style.css">
</head>

<body>
    <!-- side bar -->
    <div class="sidebar">
        <a class="sidebar-brand d-flex align-items-center justify-content-center" href="#">
            <div class="sidebar-brand-icon rotate-n-15">
                <img src="../assets/img/logo.png" width="50" height="50"></img>
            </div>
            <div class="sidebar-brand-text">Menu</div>
        </a>
        <hr class="mx-auto" style="max-width: 100%; width: 95%; margin-top: 15px;">
        <ul class="list-unstyled container">
            <li class="side-item">
                <a class="nav-link" href="../index.html">
                    <i class="fas fa-home"></i>
                    <span>Home</span></a>
            </li>
            <li class="side-item">
                <a class="nav-link" href="../pasien/pasien.html">
                    <i class="fas fa-user fa"></i>
                    <span>Pasien</span></a>
            </li>
            <li class="side-item">
                <a class="nav-link" href="../dokter/dokter.html">
                    <i class="fas fa-user fa"></i>
                    <span>Dokter</span></a>
            </li>
            <li class="side-item">
                <a class="nav-link" href="../obat/obat.html">
                    <i class="fas fa-pills fa"></i>
                    <span>Obat</span></a>
            </li>
            <li class="side-item">
                <a class="nav-link" href="../rekamMedis/rekamMedis.html">
                    <i class="fas fa-notes-medical"></i>
                    <span>Rekam Medis</span></a>
            </li>
        </ul>
        <hr class="mx-auto" style="max-width: 100%; width: 95%; margin-top: 15px;">
    </div>

    <!-- NAVBAR -->
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
        </div>
    </nav>

    <!-- Main Content -->
    <div class="content">
        <div class="container-fluid">
            <div style="display: flex;">
                <div>
                    <h2>Dashboard Rekam Medis Pasien</h2>
                    <p class="subtitle">Electronic Medical Record</p>
                </div>
            </div>
            <div class="container mt-5 text-center">
                <!-- Button untuk membuka modal -->
                <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#rekamMedisModal">
                    Buka Form Data Rekam Medis
                </button>
            </div>

            <!-- Modal -->
            <div class="modal fade" id="rekamMedisModal" tabindex="-1" aria-labelledby="rekamMedisModalLabel" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="rekamMedisModalLabel">Form Data Rekam Medis Pasien</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div class="modal-body">
                            <!-- Form Rekam Medis -->
                            <form id="rekamMedisForm">
                                <div class="form-group">
                                    <label for="pasienId">ID Pasien:</label>
                                    <input type="text" class="form-control" id="pasienId" name="pasienId" required>
                                </div>

                                <div class="form-group">
                                    <label for="diagnosis">Diagnosis:</label>
                                    <textarea class="form-control" id="diagnosis" name="diagnosis" rows="3" required></textarea>
                                </div>

                                <div class="form-group">
                                    <label for="treatment">Pengobatan:</label>
                                    <textarea class="form-control" id="treatment" name="treatment" rows="3" required></textarea>
                                </div>

                                <div class="form-group">
                                    <label for="doctorNotes">Catatan Dokter:</label>
                                    <textarea class="form-control" id="doctorNotes" name="doctorNotes" rows="3" required></textarea>
                                </div>

                                <button type="button" class="btn btn-primary" onclick="submitRekamMedis()">Submit</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <hr>

            <h4 class="text-center">Data Rekam Medis Pasien</h4>
            <p class="text-center">Rekam medis berisi data klinis pasien selama proses diagnosis dan pengobatan (treatment). Rekam medis merupakan bukti tertulis tentang proses pelayanan yang diberikan oleh dokter. Setiap dokter diharapkan mengisi rekam medis dengan benar, lengkap, dan tepat waktu untuk setiap kegiatan pelayanan medis yang dilakukan.</p>
            <table class="table table-bordered mt-3">
                <thead>
                    <tr>
                        <th>No.</th>
                        <th>ID Pasien</th>
                        <th>Diagnosis</th>
                        <th>Pengobatan</th>
                        <th>Catatan Dokter</th>
                        <th>Tanggal</th>
                        <th>Aksi</th>
                    </tr>
                </thead>
                <tbody id="rekamMedisData">
                    <!-- Data Rekam Medis akan dimuat disini -->
                </tbody>
            </table>
        </div>

        <script>
            // Function to submit Rekam Medis form data via Fetch API
            function submitRekamMedis() {
                const formData = new FormData(document.getElementById('rekamMedisForm'));

                fetch('rekamMedis_process.php', {
                    method: 'POST',
                    body: formData
                })
                .then(response => response.text())
                .then(data => {
                    alert(data); // Display success or error message from PHP
                    document.getElementById('rekamMedisForm').reset(); // Reset form after submission
                    $('#rekamMedisModal').modal('hide'); // Close modal after submit
                    loadRekamMedisData(); // Reload data table
                })
                .catch(error => {
                    console.error('Error:', error);
                });
            }

            // Function to load Rekam Medis data from the server and populate the table
            function loadRekamMedisData() {
                fetch('rekamMedis_fetch.php')
                .then(response => response.json())
                .then(data => {
                    let tableBody = document.getElementById('rekamMedisData');
                    tableBody.innerHTML = ''; // Clear the table
                    data.forEach((record, index) => {
                        let row = document.createElement('tr');
                        row.innerHTML = `
                            <td>${index + 1}</td>
                            <td>${record.pasienId}</td>
                            <td>${record.diagnosis}</td>
                            <td>${record.treatment}</td>
                            <td>${record.doctorNotes}</td>
                            <td>${record.date}</td>
                            <td>
                                <button class="btn btn-sm btn-warning">Edit</button>
                                <button class="btn btn-sm btn-danger">Hapus</button>
                            </td>
                        `;
                        tableBody.appendChild(row);
                    });
                })
                .catch(error => {
                    console.error('Error loading Rekam Medis data:', error);
                });
            }

            // Load Rekam Medis data when page loads
            window.onload = loadRekamMedisData;
        </script>

        <!-- Bootstrap JS -->
        <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    </div>
</body>

</html>
